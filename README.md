# æ™ºèƒ½æ°´æ—ç®±ç›£æ§ç³»çµ±

![ç‰ˆæœ¬](https://img.shields.io/badge/ç‰ˆæœ¬-1.0.0-blue)
![Next.js](https://img.shields.io/badge/Next.js-14.0.0-blueviolet)
![Docker](https://img.shields.io/badge/Docker-æ”¯æ´-brightgreen)

ä¸€å€‹åŸºæ–¼ Next.js é–‹ç™¼çš„ç¾ä»£åŒ–æ™ºèƒ½æ°´æ—ç®±ç›£æ§ç³»çµ±ï¼Œæä¾›å³æ™‚è¦–è¨Šç›£æ§ã€æº«åº¦ç›£æ¸¬ã€é­šç¾¤è¨ˆæ•¸ä»¥åŠè¨­å‚™é ç¨‹æ§åˆ¶ç­‰åŠŸèƒ½ã€‚

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

- **å³æ™‚è¦–è¨Šç›£æ§**ï¼šé€é HLS ä¸²æµæŠ€è¡“ï¼Œæä¾›ä½å»¶é²çš„æ°´æ—ç®±å³æ™‚è¦–è¨Šã€‚
- **æº«åº¦è³‡æ–™å³æ™‚ç›£æ§**ï¼šé€é WebSocket é€£æ¥ï¼Œå¯¦æ™‚è¨˜éŒ„å’Œé¡¯ç¤ºæ°´æº«è®ŠåŒ–è¶¨å‹¢ã€‚
- **é­šç¾¤æ•¸é‡ç›£æ¸¬**ï¼šä½¿ç”¨äººå·¥æ™ºæ…§å½±åƒè¾¨è­˜æŠ€è¡“ï¼Œå¯¦æ™‚ç›£æ¸¬é­šç¼¸ä¸­çš„é­šéš»æ•¸é‡ã€‚
- **è¨­å‚™é ç¨‹æ§åˆ¶**ï¼š
  - LED ç‡ˆå…‰æ§åˆ¶
  - è‡ªå‹•é¤µé£Ÿç³»çµ±æ§åˆ¶
  - åŠ ç†±å™¨æ§åˆ¶

## ğŸ”§ æŠ€è¡“æ¶æ§‹

- **å‰ç«¯æ¡†æ¶**ï¼šNext.js 14
- **UI è¨­è¨ˆ**ï¼šTailwind CSS
- **å³æ™‚é€šè¨Š**ï¼šWebSocket
- **è¦–è¨Šä¸²æµ**ï¼šHTTP Live Streaming (HLS)
- **åœ–è¡¨å‘ˆç¾**ï¼šRecharts

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å®‰è£ä¾è³´

```bash
npm install
# æˆ–
yarn install
```

### å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨

```bash
npm run dev
# æˆ–
yarn dev
```

é–‹å•Ÿ [http://localhost:3000](http://localhost:3000) ç€è¦½ç³»çµ±ç•Œé¢ã€‚

## ğŸ‹ Docker éƒ¨ç½²æŒ‡å—

æœ¬å°ˆæ¡ˆæä¾› Docker æ”¯æ´ï¼Œä¾¿æ–¼åœ¨å„ç¨®ç’°å¢ƒä¸­å¿«é€Ÿéƒ¨ç½²å’Œé‹è¡Œç³»çµ±ã€‚

### å¾ Docker Hub æ‹‰å–æ˜ åƒ

æˆ‘å€‘å·²å°‡æ˜ åƒä¸Šå‚³è‡³ Docker Hubï¼Œæ‚¨å¯ä»¥ç›´æ¥æ‹‰å–ä½¿ç”¨ï¼š

```bash
docker pull oomaybeoo/aquarium
```

### é‹è¡Œ Docker å®¹å™¨

æ‹‰å–æ˜ åƒå¾Œï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å•Ÿå‹•å®¹å™¨ï¼š

```bash
docker run -d -p 3000:3000 --name aquarium oomaybeoo/aquarium
```

å•Ÿå‹•å¾Œï¼Œåœ¨ç€è¦½å™¨ä¸­è¨ªå• [http://localhost:3000](http://localhost:3000) å³å¯ä½¿ç”¨ç³»çµ±ã€‚

### ä½¿ç”¨ Docker Compose

å°ˆæ¡ˆæä¾›äº† docker-compose.yml é…ç½®æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Docker Compose ä¸€éµéƒ¨ç½²ï¼š

```bash
docker-compose up -d
```

### è‡ªè¡Œæ§‹å»ºæ˜ åƒ

å¦‚æœæ‚¨æƒ³è‡ªè¡Œä¿®æ”¹ä¸¦æ§‹å»ºæ˜ åƒï¼Œå¯ä»¥ä½¿ç”¨ï¼š

```bash
docker build -t oomaybeoo/aquarium .
```

æ§‹å»ºå®Œæˆå¾Œï¼Œæ¨é€è‡³ Docker Hubï¼š

```bash
docker push oomaybeoo/aquarium
```

### Docker ç›¸é—œæ–‡ä»¶èªªæ˜

æœ¬å°ˆæ¡ˆåŒ…å«ä»¥ä¸‹ Docker ç›¸é—œæ–‡ä»¶ï¼š

- `Dockerfile` - å®šç¾©äº†å¤šéšæ®µæ§‹å»ºéç¨‹ï¼Œå„ªåŒ–å®¹å™¨å¤§å°å’Œæ€§èƒ½
- `docker-compose.yml` - æä¾›äº†å®¹å™¨ç·¨æ’é…ç½®
- `docker-push.bat` - Windows ç’°å¢ƒä¸‹ç”¨æ–¼æ§‹å»ºå’Œæ¨é€æ˜ åƒçš„æ‰¹è™•ç†è…³æœ¬
- `docker-push.sh` - Unix/Linux ç’°å¢ƒä¸‹ç”¨æ–¼æ§‹å»ºå’Œæ¨é€æ˜ åƒçš„è…³æœ¬

## ğŸ“Š ç³»çµ±çµ„ä»¶èªªæ˜

### VideoPlayer çµ„ä»¶

æä¾› HLS è¦–è¨Šä¸²æµæ’­æ”¾åŠŸèƒ½ï¼Œæ”¯æ´ä½å»¶é²æ¨¡å¼ã€‚

```tsx
<VideoPlayer src="https://your-hls-stream-url.m3u8" />
```

### TemperatureChart çµ„ä»¶

é¡¯ç¤ºå³æ™‚æ°´æº«æ•¸æ“šåœ–è¡¨ï¼Œé€šé WebSocket é€£æ¥ `wss://a1wss.iside.space/ws/temp/` ç²å–æ•¸æ“šã€‚

### FishCounter çµ„ä»¶

é¡¯ç¤ºé­šç¾¤æ•¸é‡ç›£æ¸¬çµæœï¼Œé€šé WebSocket é€£æ¥ `wss://a1wss.iside.space/ws/fish/` ç²å–æ•¸æ“šã€‚

### ModeSelector çµ„ä»¶

æä¾›è¨­å‚™æ§åˆ¶ç•Œé¢ï¼Œé€šé WebSocket é€£æ¥ `wss://a1wss.iside.space/ws/mode/` ç™¼é€æ§åˆ¶æŒ‡ä»¤ã€‚

## ğŸ“¡ WebSocket API èªªæ˜

ç³»çµ±ä½¿ç”¨ä¸‰å€‹ WebSocket ç«¯é»é€²è¡Œæ•¸æ“šå‚³è¼¸ï¼š

1. **æº«åº¦ç›£æ¸¬**ï¼š`wss://a1wss.iside.space/ws/temp/`
   - æ¥æ”¶æ ¼å¼ï¼š`{"message": "25.5 => server echo"}`

2. **é­šç¾¤è¨ˆæ•¸**ï¼š`wss://a1wss.iside.space/ws/fish/`
   - æ¥æ”¶æ ¼å¼ï¼š`{"message3": "29"}`

3. **è¨­å‚™æ§åˆ¶**ï¼š`wss://a1wss.iside.space/ws/mode/`
   - ç™¼é€æ ¼å¼ï¼š`{"message": "LED_ON"}` / `{"message": "LED_OFF"}`
   - ç™¼é€æ ¼å¼ï¼š`{"message": "FOOD_ON"}` / `{"message": "FOOD_OFF"}`
   - ç™¼é€æ ¼å¼ï¼š`{"message": "HOT_ON"}` / `{"message": "HOT_OFF"}`

## ğŸ“± éŸ¿æ‡‰å¼è¨­è¨ˆ

ç³»çµ±ç•Œé¢æ”¯æ´ä¸åŒå°ºå¯¸çš„è¨­å‚™é¡¯ç¤ºï¼š

- æ¡Œé¢é›»è…¦
- å¹³æ¿é›»è…¦
- ç§»å‹•è¨­å‚™

## ğŸ”’ ç³»çµ±è¦æ±‚

- Node.js 16.0 æˆ–ä»¥ä¸Š
- æ”¯æ´ç¾ä»£ç€è¦½å™¨ (Chrome, Firefox, Safari, Edge)
- ç¶²çµ¡é€£æ¥ï¼Œç”¨æ–¼ WebSocket å’Œ HLS ä¸²æµ
- å¯é¸ï¼šDocker 20.10 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆå¦‚ä½¿ç”¨ Docker éƒ¨ç½²ï¼‰

## ğŸ“ è¨±å¯è­‰

Â© 2025 æ™ºèƒ½æ°´æ—ç®±ç›£æ§ç³»çµ±